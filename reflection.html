<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal & Reflection</title>
    <link rel="stylesheet" href="tryout.css">
</head>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Journal & Reflection</h1>
            <p>Record your journey, reflect on your progress, and hold yourself accountable.</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="content-wrapper">
        <section id="journal-section">
            <h2>Today's Reflection</h2>
            <form id="journal-form">
                <label for="what-happened">What Happened Today:</label><br>
                <textarea id="what-happened" name="what-happened" rows="4" placeholder="Describe today's events..."></textarea><br>

                <label for="feelings">How Did I Feel:</label><br>
                <textarea id="feelings" name="feelings" rows="4" placeholder="Reflect on your emotions..."></textarea><br>

                <label for="lessons">What Did I Learn:</label><br>
                <textarea id="lessons" name="lessons" rows="4" placeholder="Note key lessons or insights..."></textarea><br>

                <label for="accountability">Accountability Check-In:</label><br>
                <textarea id="accountability" name="accountability" rows="4" placeholder="Evaluate how you're aligning with your goals..."></textarea><br>

                <button type="submit">Save Reflection</button>
            </form>
        </section>

        <section id="accountability-section">
            <h2>Accountability Overview</h2>
            <p>Track your progress and revisit previous reflections to see your growth over time.</p>
            <ul id="past-reflections">
                <!-- Placeholder for dynamically loaded past reflections -->
                <li>No past reflections yet. Start journaling today!</li>
            </ul>
        </section>
    <script src="global-header.js"></script>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Zahm's Corner. All rights reserved.</p>
    </footer>
    <!-- JavaScript -->
<script>
    document.getElementById('journal-form').addEventListener('submit', function (e) {
        e.preventDefault();

        // Gather input data
        const whatHappened = document.getElementById('what-happened').value;
        const feelings = document.getElementById('feelings').value;
        const lessons = document.getElementById('lessons').value;
        const accountability = document.getElementById('accountability').value;

        // Prepare data to send to Google Apps Script
        const reflection = {
            date: new Date().toLocaleDateString(),
            whatHappened,
            feelings,
            lessons,
            accountability,
        };

        // Save locally in case user wants to revisit
        let reflections = JSON.parse(localStorage.getItem('reflections')) || [];
        reflections.push(reflection);
        localStorage.setItem('reflections', JSON.stringify(reflections));

        // Send data to Google Apps Script
        fetch("https://script.google.com/macros/s/AKfycbz22ZkHjJGaz6H4fED1AewUIyPm1W9-QfxG3Mccl0S7xyRbrruy50kpiKaHzvvCOUlJ6g/exec", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(reflection),
        })
            .then((response) => {
                if (response.ok) {
                    alert("Reflection submitted successfully!");
                } else {
                    alert("Failed to submit reflection. Please try again.");
                }
            })
            .catch((error) => {
                console.error("Error submitting reflection:", error);
                alert("An error occurred. Please try again.");
            });

        // Display in accountability section
        const list = document.getElementById('past-reflections');
        const listItem = document.createElement('li');
        listItem.textContent = `Reflection for ${reflection.date}: ${reflection.whatHappened}`;
        list.prepend(listItem);

        // Clear form
        this.reset();
    });

    // Load past reflections
    const reflections = JSON.parse(localStorage.getItem('reflections')) || [];
    const list = document.getElementById('past-reflections');
    reflections.forEach((reflection) => {
        const listItem = document.createElement('li');
        listItem.textContent = `Reflection for ${reflection.date}: ${reflection.whatHappened}`;
        list.prepend(listItem);
    });
</script>

</body>
</html>
