<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal & Reflection</title>
    <link rel="stylesheet" href="tryout.css">
    <script type="module">
        // Import the Firebase configuration
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCJFEoNrjyZNrvaMR9uKQYzWiQ7K3uNXkY", // Replace with your Web API Key
            authDomain: "lezahm.firebaseapp.com",
            projectId: "lezahm",
            storageBucket: "lezahm.appspot.com",
            messagingSenderId: "792842956911",
            appId: "1:792842956911:web:6bf5f65694c221ff309d9a"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener("DOMContentLoaded", async () => {
            // Load past reflections
            const reflectionsList = document.getElementById("past-reflections");
            const querySnapshot = await getDocs(collection(db, "reflections"));

            querySnapshot.forEach((doc) => {
                const reflection = doc.data();
                const listItem = document.createElement("li");
                listItem.textContent = `Reflection for ${reflection.date}: ${reflection.whatHappened}`;
                reflectionsList.appendChild(listItem);
            });

            // Submit the journal entry
            document.getElementById("journal-form").addEventListener("submit", async (e) => {
                e.preventDefault();

                const whatHappened = document.getElementById("what-happened").value;
                const feelings = document.getElementById("feelings").value;
                const lessons = document.getElementById("lessons").value;
                const accountability = document.getElementById("accountability").value;

                const reflection = {
                    date: new Date().toLocaleDateString(),
                    whatHappened,
                    feelings,
                    lessons,
                    accountability,
                };

                try {
                    await addDoc(collection(db, "reflections"), reflection);
                    alert("Reflection submitted successfully!");

                    // Add to past reflections
                    const listItem = document.createElement("li");
                    listItem.textContent = `Reflection for ${reflection.date}: ${reflection.whatHappened}`;
                    reflectionsList.appendChild(listItem);

                    // Clear form
                    e.target.reset();
                } catch (error) {
                    console.error("Error submitting reflection:", error);
                    alert("An error occurred. Please try again.");
                }
            });
        });
    </script>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Journal & Reflection</h1>
            <p>Record your journey, reflect on your progress, and hold yourself accountable.</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="content-wrapper">
        <section id="journal-section">
            <h2>Today's Reflection</h2>
            <form id="journal-form">
                <label for="what-happened">What Happened Today:</label><br>
                <textarea id="what-happened" name="what-happened" rows="4" placeholder="Describe today's events..."></textarea><br>

                <label for="feelings">How Did I Feel:</label><br>
                <textarea id="feelings" name="feelings" rows="4" placeholder="Reflect on your emotions..."></textarea><br>

                <label for="lessons">What Did I Learn:</label><br>
                <textarea id="lessons" name="lessons" rows="4" placeholder="Note key lessons or insights..."></textarea><br>

                <label for="accountability">Accountability Check-In:</label><br>
                <textarea id="accountability" name="accountability" rows="4" placeholder="Evaluate how you're aligning with your goals..."></textarea><br>

                <button type="submit">Save Reflection</button>
            </form>
        </section>

        <section id="accountability-section">
            <h2>Accountability Overview</h2>
            <p>Track your progress and revisit previous reflections to see your growth over time.</p>
            <ul id="past-reflections">
                <!-- Placeholder for dynamically loaded past reflections -->
                <li>No past reflections yet. Start journaling now!</li>
            </ul>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Zahm's Corner. All rights reserved.</p>
    </footer>
<script src="global-header.js"></script>
</body>
</html>
